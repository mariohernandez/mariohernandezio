#!/usr/bin/env bash
# Warn developers when `src/_includes/components/button/button.njk` is staged
# This hook intentionally prints a friendly notice and allows the commit to proceed.

set -euo pipefail

FILE="src/_includes/components/button/button.njk"

# Get staged files (added/modified/copied/renamed/typechanged)
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMRTUXB || true)

if echo "$STAGED_FILES" | grep -qE "^${FILE}$"; then
  cat <<'NOTICE'
=====================================================================
NOTICE: You staged changes to `src/_includes/components/button/button.njk`.

This component is used throughout the site. Before committing, please:
  - Double-check accessibility (aria attributes, visible labels).
  - Confirm any API changes to the macro (attrs object vs string) and
    update call sites accordingly.
  - Run the dev server to preview: `npm start` or `npm run watch:css`.
  - Update `.github/copilot-instructions.md` examples if you changed usage.

If you intended these changes, continue with the commit. To abort, run:
  git reset --patch "${FILE}"
  or press Ctrl+C now to cancel this commit.
=====================================================================
NOTICE
fi

exit 0
